<!DOCTYPE html>
<!--notes ido:
	Still need to clean the assets/plugin , assets/scripts, assets/img  folders....
-->
<!-- 
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 2.3.2
Version: 1.4
Author: KeenThemes
Website: http://www.keenthemes.com/preview/?theme=metronic
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469
-->
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
	<meta charset="utf-8" />

	<meta http-equiv="Access-Control-Allow-Origin" content="*">
	<title>Metronic | Admin Dashboard Template</title>
	<meta content="width=device-width, initial-scale=1.0" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	<!-- BEGIN GLOBAL MANDATORY STYLES -->
	<link href="assets/plugins/bootstrap/css/bootstrap-rtl.min.css" rel="stylesheet" type="text/css"/>
	<link href="assets/plugins/bootstrap/css/bootstrap-responsive-rtl.min.css" rel="stylesheet" type="text/css"/>
	<link href="assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/> <!--icons-->
	<link href="assets/css/style-metro-rtl.css" rel="stylesheet" type="text/css"/>
	<link href="assets/css/style-rtl.css" rel="stylesheet" type="text/css"/>
	<link href="assets/css/style-responsive-rtl.css" rel="stylesheet" type="text/css"/>
	<link href="assets/css/themes/default-rtl.css" rel="stylesheet" type="text/css" id="style_color"/>
	<link href="assets/plugins/bootstrap-switch/static/stylesheets/bootstrap-switch-metro-rtl.css" rel="stylesheet" type="text/css"/>
	<link rel="stylesheet" type="text/css" href="assets/plugins/chosen-bootstrap/chosen/chosen-rtl.css" />
	<link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-toggle-buttons/static/stylesheets/bootstrap-toggle-buttons-rtl.css" />
	<link rel="shortcut icon" href="favicon.ico" />


	<!-- Ido Styling -->
	<style type="text/css">
		.dataTable .row-details{width: auto; padding-left: 18px;}
		#dashboard > .row-fluid{display:none;}
		#dashboard #managers.row-fluid{min-width: 51.46em;}
		table.nodes thead{display:none;}
		tr.now-deleting{display:none;}
		tr[data-id="-1"] > td {background-color:yellow !important;}
		tr[data-id="-1"] > td > .row-details {display: none;}
		

		.tile .tile-object{bottom:8px;}
		.tile .tile-object .number{font-size:34px;}
		.tile .tile-object .name{font-size:15px;}
		#campaigns .tile,#campaigns .tile:hover{border:none !important; cursor: auto;}
		#tbl-campaigns_wrapper .row-fluid:first-child .span6:first-child{display: none;}
		#tbl-campaigns_wrapper .row-fluid:first-child .span6:nth-child(2){margin-right: 0 !important;}
		table#tbl-campaigns .delete, table#tbl-campaigns .edit{text-decoration: underline; color: blue;}
		table#tbl-campaigns tr.cancelled-campaign a.delete{display:none;}
		table#tbl-campaigns tr.cancelled-campaign td:first-child input:after{content:"dead";}
		#edit-campaign{display: none;}
		input[type="text"]{width: auto;}

		/*temp (solve problem of 2 large managers table */
		/*.portlet-body{overflow: auto;}*/

		.input-line-holder {display: inline-block; padding: 0 20px;}
		#data-upload .portlet-body .control-group{display:none;}
		#data-upload .portlet-body .control-group:first-child{display:block;}
		
	/*scheaduled messages*/
	
	</style>

</head>
<body class="page-header-fixed">
	<!-- BEGIN HEADER -->   
	<div class="header navbar navbar-inverse navbar-fixed-top">
		<!-- BEGIN TOP NAVIGATION BAR -->
		<div class="navbar-inner">
			<div class="container-fluid">
				<!-- BEGIN LOGO -->
				<a class="brand" href="index.html">
				<img src="assets/img/logo.png" alt="logo" />
				</a>
				<!-- END LOGO -->
				<!-- BEGIN RESPONSIVE MENU TOGGLER -->
				<a href="javascript:;" class="btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse">
				<img src="assets/img/menu-toggler.png" alt="" />
				</a>          
				<!-- END RESPONSIVE MENU TOGGLER -->            
				<!-- BEGIN TOP NAVIGATION MENU -->              
				<ul class="nav pull-left">
					<!-- BEGIN USER LOGIN DROPDOWN -->
					<li class="dropdown user">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
						<span class="username">Bob Nilson</span>
						<i class="icon-angle-down"></i>
						</a>
						<ul class="dropdown-menu">
							<li><a href="login.html"><i class="icon-key"></i> Log Out</a></li>
						</ul>
					</li>
					<!-- END USER LOGIN DROPDOWN -->
					<!-- END USER LOGIN DROPDOWN -->
				</ul>
				<!-- END TOP NAVIGATION MENU --> 
			</div>
		</div>
		<!-- END TOP NAVIGATION BAR -->
	</div>
	<!-- END HEADER -->
	<!-- BEGIN CONTAINER -->
	<div class="page-container">
		<!-- BEGIN SIDEBAR -->
		<div class="page-sidebar nav-collapse collapse">
			<!-- BEGIN SIDEBAR MENU -->        
			<ul class="page-sidebar-menu">
				<li data-section="campaigns">
					<a href="#">
						<i class="icon-cogs"></i> 
						<span class="title">ניהול משתמשים</span>
						<span class="selected"></span>
					</a>
				</li>
			</ul>
			<!-- END SIDEBAR MENU -->
		</div>
		<!-- END SIDEBAR -->
		<!-- BEGIN PAGE -->
		<div class="page-content">
			<!-- BEGIN PAGE CONTAINER-->
			<div class="container-fluid">
				<!-- BEGIN PAGE HEADER-->
				<div class="row-fluid">
					<div class="span12">
						<!-- BEGIN STYLE CUSTOMIZER -->
							<!-- IDO DELETED -->
						<!-- END STYLE CUSTOMIZER -->    
						<!-- BEGIN PAGE TITLE & BREADCRUMB-->
						<h3 class="page-title">
							פרומונים
							<small>מעשיות וסיפורים</small>
						</h3>
						<!-- END PAGE TITLE & BREADCRUMB-->
					</div>
				</div>
				<!-- END PAGE HEADER-->
				<div id="dashboard">
					<div class="row-fluid" id="managers">
						<!-- BEGIN EXAMPLE TABLE PORTLET-->
						<div class="portlet box light-grey" id="managers-list">
							<div class="portlet-title">
								<div class="caption"><i class="icon-globe"></i>כל הקמפיינים</div>
							</div>
							<div class="portlet-body">
								<div class="table-toolbar">
									<div class="btn-group">
										<button id="add-new-manager" class="btn green">
											Add New <i class="icon-plus"></i>
										</button>
									</div>
								</div>
								<table class="table table-striped table-bordered table-hover" id="tbl-managers">
									<thead>
										<tr>
											<th data-field="name">שם איש הקשר</th>
											<th data-field="vendorName">שם המנוי</th>
											<th data-field="phoneNumber">טלפון</th>
											<th data-field="email">אימייל</th>									
											<th>עריכה</th>
											<th>מחיקה</th>
										</tr>
									</thead>
									<tbody>
									</tbody>
								</table>
							</div>
						</div>
						<div class="portlet box blue" id="edit-manager" data-id="">
							<div class="portlet-title">
								<div class="caption">
									<i class="icon-reorder"></i> עריכת מנהל
									<span>---</span>
									<span class="status-display"></span>
								</div>
								<div class="tools hidden-phone">
									<a href="javascript:;" class="collapse"></a>
									<a href="#portlet-config" data-toggle="modal" class="config"></a>
									<a href="javascript:;" class="reload"></a>
									<a href="javascript:;" class="remove"></a>
								</div>
							</div>
							<div class="portlet-body form">
								<div class="form-horizontal">
									<div class="form-wizard">
										<div class="navbar steps">
											<div class="navbar-inner">
												<ul class="row-fluid">
													<li class="span3 active">
														<a href="#tab1" data-toggle="tab" class="step active">
															<span class="number">1</span>
															<span class="desc"><i class="icon-ok"></i>פרטי איש הקשר</span>
														</a>
													</li>
													<li class="span3">
														<a href="#tab2" data-toggle="tab" class="step">
															<span class="number">2</span>
															<span class="desc"><i class="icon-ok"></i>מיקוד הנמענים</span>   
														</a>
													</li>
													<li class="span3">
														<a href="#tab3" data-toggle="tab" class="step">
															<span class="number">3</span>
															<span class="desc"><i class="icon-ok"></i>עריכת תוכן, תזמון, הפעלה</span>   
														</a>
													</li>
													
													<li class="span3">
														<a href="#tab4" data-toggle="tab" class="step">
															<span class="number">4</span>
															<span class="desc"><i class="icon-ok"></i> תוצאות</span>   
														</a>
													</li>
												</ul>
											</div>
										</div>
										<div class="tab-content">
											<div class="alert alert-error hide">
												<button class="close" data-dismiss="alert"></button>
												You have some form errors. Please check below.
											</div>
											<div class="alert alert-success hide">
												<button class="close" data-dismiss="alert"></button>
												Your form validation is successful!
											</div>
											<div class="tab-pane active" id="tab1">
												<h3 class="block">ראשי</h3>
												<div class="control-group">
													<label class="control-label">שם הקמפיין</label>
													<div class="controls">
														<input type="text" class="span4 m-wrap" name="name" id="name"/>
													</div>
												</div>
												<div class="control-group">
													<label class="control-label">תאריך יצירה</label>
													<div class="controls">
														<input type="text" class="span4 m-wrap" name="createdAt" disabled/>
													</div>
												</div>
												<div class="control-group">
													<label class="control-label">קטגוריה</label>
													<div class="controls">
														<input type="text" class="span4 m-wrap" name="category" id="category"/>
													</div>
												</div>
												<div class="control-group">
													<label class="control-label">יעדים</label>
													<div class="controls">
														<textarea class="span6 m-wrap" rows="3" name="goals" id="goals"></textarea>
													</div>												
												</div>
												<div class="control-group">
													<label class="control-label">תקציב</label>
													<div class="controls">
														<input type="text" class="span4 m-wrap" name="budget" id="budget"/>
													</div>
												</div>
											</div>
											<div class="tab-pane" id="tab2">
												<h3 class="block">מיקוד הנמענים</h3>
												<div id="campaign-filters" filters></div>
											</div>
											<div class="tab-pane" id="tab3">
												<h3 class="block">עריכת תוכן ותזמון</h3>
												<div class="control-group">
													<label class="control-label">הודעה</label>
													<div class="controls">
														<textarea class="span6 m-wrap" rows="3" name="message"></textarea>
													</div>
												</div>
												<div class="control-group">
													<label class="control-label">לינק</label>
													<div class="controls">
														<input type="text" class="span4 m-wrap" name="link" id="link"/>
													</div>
												</div>
												<div class="control-group">
													<label class="control-label">צליל</label>
													<div class="controls">
														<select name="sound" id="sound" class="span3">
															<option value="">Select</option>
															<option value="alarm">alarm</option>
															<option value="alarm">bell</option>
															<option value="ring">ring</option>
														</select>
													</div>
												</div>
												<div class="control-group">
													<label class="control-label">תזמון</label>
													<div class="controls">
														<select name="recurring" id="recurring" class="span3">
															<option value="0">חד פעמי</option>
															<option value="1">יומי</option>
															<option value="2">שבועי</option>
														</select>
													</div>
												</div>
												<div class="control-group">
													<label class="control-label">שעה</label>
													<div class="controls">
														<select name="dayOfWeek" id="dayOfWeek" class="span3">
															<option value="0">ראשון</option>
															<option value="1">שני</option>
															<option value="2">שלישי</option>
															<option value="3">רביעי</option>
															<option value="4">חמישי</option>
															<option value="5">שישי</option>
															<option value="6">שבת</option>
														</select>
													</div>
												</div>
												<div class="control-group">
													<label class="control-label">שעה</label>
													<div class="controls">
														<select name="hour" id="hour" class="span3">
															<option value="0">0:00</option>
															<option value="1">1:00</option>
															<option value="2">2:00</option>
															<option value="3">3:00</option>
															<option value="4">4:00</option>
															<option value="5">5:00</option>
															<option value="6">6:00</option>
															<option value="7">7:00</option>
															<option value="8">8:00</option>
															<option value="9">9:00</option>
															<option value="10">10:00</option>
															<option value="11">11:00</option>
															<option value="12">12:00</option>
															<option value="13">13:00</option>
															<option value="14">14:00</option>
															<option value="15">15:00</option>
															<option value="16">16:00</option>
															<option value="17">17:00</option>
															<option value="18">18:00</option>
															<option value="19">19:00</option>
															<option value="20">20:00</option>
															<option value="21">21:00</option>
															<option value="22">22:00</option>
															<option value="23">23:00</option>
														</select>
													</div>
												</div>
												<div class="control-group">
													<label class="control-label">מבוסס מיקום</label>
													<div class="controls">
														<select name="locationBase" id="locationBase" class="span3">
															<option value="2" selected="selected">ארצי</option>
															<option value="1">אזורי</option>
															<option value="0">מקומי</option>
														</select>
													</div>
												</div>
												<div class="control-group">
													<label class="control-label">פעיל</label>
													<div class="controls">
														<div class="input-line-holder">
															<label class="checkbox line">
																<input type="checkbox" name="isActive" id="isActive" value="1" /> 
															</label>
														</div>
													</div>
												</div>
											</div>
											<div class="tab-pane" id="tab4">
												<h3 class="block">סטטיסטיקה</h3>
												<div class="tiles">
													<div class="tile bg-blue" id="roost-history">
														<div class="tile-body">
															<i class="icon-bell"></i>
														</div>
														<div class="tile-object">
															<div class="name">
																PUSH
															</div>
															<div class="number"></div>
														</div>
													</div>
												</div>
												<div class="tile bg-green" id="sms-history">
													<div class="tile-body">
														<i class="icon-comments-alt"></i>
													</div>
													<div class="tile-object">
														<div class="name">
															SMS
														</div>
														<div class="number"></div>
													</div>
												</div>
											</div>
										</div>
										<div class="form-actions clearfix">
											<a href="javascript:;" class="btn button-previous" id="btn-all-campaings">
											<i class="m-icon-swapleft"></i> חזרה לכל הקמפיינים
											</a>
											<a href="javascript:;" class="btn green button-submit" id="btn-save-campaign">
											שמור שינויים <i class="m-icon-swapright m-icon-white"></i>
											</a>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- END PAGE CONTAINER-->    
		</div>
		<!-- END PAGE -->
	</div>
	<!-- END CONTAINER -->
	<!-- BEGIN FOOTER -->
	<div class="footer">
		<div class="footer-inner">
			2013 &copy; Metronic by keenthemes.
		</div>
	</div>
	<!-- END FOOTER -->
	<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
	<!-- BEGIN CORE PLUGINS -->   
	<script src="assets/plugins/jquery-1.10.1.min.js" type="text/javascript"></script>
	<!--
	<script src="assets/plugins/jquery-migrate-1.2.1.min.js" type="text/javascript"></script> //removed for deployment
	<!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->
	<script src="assets/plugins/jquery-ui/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>      
	<script src="assets/plugins/bootstrap/js/bootstrap-rtl.min.js" type="text/javascript"></script>
	<!--
	<script src="assets/plugins/bootstrap-hover-dropdown/twitter-bootstrap-hover-dropdown.min.js" type="text/javascript" ></script>
	<!--[if lt IE 9]>
	<script src="assets/plugins/excanvas.min.js"></script>
	<script src="assets/plugins/respond.min.js"></script>  
	<![endif]-->   
	
	<!--<script src="assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>-->
	<script src="assets/plugins/jquery.blockui.min.js" type="text/javascript"></script>  

	<!--<script src="assets/plugins/uniform/jquery.uniform.min.js" type="text/javascript" ></script>-->
	<!-- END CORE PLUGINS -->
	<!-- BEGIN PAGE LEVEL PLUGINS -->
	<!--
	<script src="assets/plugins/flot/jquery.flot.js" type="text/javascript"></script>
	<script src="assets/plugins/flot/jquery.flot.resize.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery.pulsate.min.js" type="text/javascript"></script>
	<script src="assets/plugins/bootstrap-daterangepicker/date.js" type="text/javascript"></script>
	<script src="assets/plugins/bootstrap-daterangepicker/daterangepicker-rtl.js" type="text/javascript"></script>     
	<script src="assets/plugins/gritter/js/jquery.gritter.js" type="text/javascript"></script>
	<script src="assets/plugins/fullcalendar/fullcalendar/fullcalendar.min.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery-easy-pie-chart/jquery.easy-pie-chart.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery.sparkline.min.js" type="text/javascript"></script>
	-->
	<script src="assets/plugins/bootstrap-switch/static/js/bootstrap-switch.js" type="text/javascript" ></script><!-- for ON/Off switch -->  
	
	 <script src="assets/plugins/mustache.js" type="text/javascript"></script> <!-- mustache -->
	 <script src="assets/plugins/jquery.ba-throttle-debounce.js" type="text/javascript"></script> <!-- jquery throtle -->
	
	<!-- END PAGE LEVEL PLUGINS -->
	<!-- BEGIN PAGE LEVEL SCRIPTS -->
	<!--<script src="assets/scripts/table-editable.js"></script>-->
	<script type="text/javascript" src="assets/plugins/bootstrap-toggle-buttons/static/js/jquery.toggle.buttons.js"></script>
	<!-- END PAGE LEVEL SCRIPTS -->
	
	<!-- BEGIN EDITABLE TABLE SCRIPTS (ido)-->
	<!--
	<script type="text/javascript" src="assets/plugins/select2/select2.min.js"></script>
	-->

	<script type="text/javascript" src="assets/plugins/data-tables/jquery.dataTables.js"></script>
	<script type="text/javascript" src="assets/plugins/data-tables/DT_bootstrap.js"></script>


	<!-- END EDITABLE TABLE SCRIPTS -->
	<!-- BEGIN IDO JS: -->
	<script type="text/javascript" src="js/jquery.jeditable.js"></script>
	<script type="text/javascript" src="js/jquery.blockui.js"></script>
	<script src="assets/scripts/app.js"></script>     
	<script src="assets/scripts/form-wizard.js"></script>     
	<!--<script src="assets/scripts/table-managed.js"></script>     -->
	<!--NAVIGATION SCRIPT-->
	<script>
		$('.page-sidebar-menu li').on('click', function(){
			$('.page-sidebar-menu li').removeClass('active');
			$(this).addClass('active');
			
			$('#dashboard > .row-fluid').hide();
			var section = $(this).attr('data-section'); 
			$('#dashboard #' + section + '.row-fluid').fadeIn();
		});
		
		$(document).ready(function(){
			$('.page-sidebar-menu li:nth-child(3)').trigger('click');
		});
	</script>

	<!--CAMPAIGNS -->
	<script>	
	function loadManagers(managerId){
		var id = managerId ? managerId : '';
		if(id){
			console.log('got to first');
			var parseManagers = function(data){
				console.log('manager data: ');
				console.log(data);

				var wizard = $('#edit-manager');
				wizard.attr('data-id',managerId);
				var textInputs = wizard.find('input[type="text"]');
				//var chbxInputs = man.find('input[type="checkbox"]');
				//var selectInputs = man.find('select');
				//var textAreas = man.find('textarea');
				//var chbxFilters = man.find('#campaign-filters input[type="checkbox"]');

				//Manager data:
				$.each(textInputs, function(index,i){
					i = $(i);
					var fieldName = i.attr('name');
					i.val(data[fieldName]);
				});
				/*$.each(chbxInputs, function(index,i){
					i = $(i);
					var fieldName = i.attr('name');
					i.prop('checked', data[fieldName] ? true : false);
				});
				$.each(selectInputs, function(index,i){
					i=$(i);
					var fieldName = i.attr('name');
					if(data[fieldName]){i.val(data[fieldName]);}
					console.log(fieldName +': '+data[fieldName]);
				});
				$.each(textAreas, function(index,i){
					i=$(i);
					var fieldName = i.attr('name');
					i.val(data[fieldName]);				
				});*/
				/*var sent = JSON.parse(data.sent);
				$('#sms-history .number').html(sent ? sent.sms : '0');
				$('#roost-history .number').html(sent ? sent.roost : '0');
				var filters = JSON.parse(data.filters);
				console.log(filters);
				console.log(chbxFilters.length);
				$.each(chbxFilters, function(index,i){
					i = $(i);
					var attr = i.attr('data-filter-attribute');
					var val = i.attr('data-filter-value');
					if(filters){
						if(filters[attr]){
							if(filters[attr].indexOf(val)>-1){
								i.prop('checked', true);		
							}
						}					
					}
				});*/
			}
		}else{
			console.log('got to secind');
			$('#tbl-managers > tbody').html('');
			var parseManagers =  function(data){
				console.log('managers data: '+data);
				var tbody = $('#tbl-managers > tbody');
				$.each(data,function(i,m){
					var status;
					var mRow = '<tr class="manager" data-id="'+m.id+'"><td>'+m.name+'</td><td>'+m.vendorName+'</td><td>'+m.phoneNumber+'</td><td>'+m.email+'</td><td><a class="edit">Edit</a></td><td><a class="delete">Delete</a></td></tr>';
					tbody.append(cRow);
					console.log(m);
				});
				$('#tbl-managers').dataTable( {
    				"bFilter": true,
    				"bInfo": false,
    				"bPaginate": false,
		    		"oLanguage": {
		   				 "sSearch": "חיפוש: "
		  			}
  				});
			}
		}
		
		$.ajax({
			type: "get",
			url: '/api/managers/'+id,
			success: parseManagers
		});
	}
	$(function(){
		App.init();
//	    TableManaged.init();
		
		$('#tbl-managers').on('click','a.delete-campaign',function(){
			$(this).parents('tr')[0].remove();
			updateManagers();
		});		

		/*===============CAMPAIGN==========*/
		$('#btn-all-managerss').on('click',function(){ //TODO add dynamic managerId
			loadCampaigns(1);
			$('#managers-list').show();
			$('#edit-manager').hide();
		}); 
		//Add new manager:
		$('#add-new-manager:not(.creating-campaign)').on('click',function(){
			$(this).addClass('creating-manger');
			$.ajax({
					type: "post",
					url: '/api/managers/1',
					data: {},
					success: function(newId) {
						alert(newId);
						console.log(newId);
						loadManagers(newId);	//TODO this could be made with just one call...					
						$('#managers-list').hide();
						$('#edit-manger').show();
					}
				});
		});
		//load single campagin
		loadMangers();
		//save campaign:
		$('#btn-save-manger').on('click',function(){
			var data = {};
			var wizard = $($(this).parents('#edit-manager')[0]);
			var id= wizard.attr('data-id');
			var chbxInputs = wizard.find('input[type="checkbox"]');
			var textInputs = wizard.find('input[type="text"]');
			var selectInputs = wizard.find('select');
			var textAreas = wizard.find('textarea');
			var chbxFilters = wizard.find('#campaign-filters input[type="checkbox"]');
			$.each(textInputs, function(index,i){
				i = $(i);
				if(!i.is(':disabled')){
					var fieldName = i.attr('name');
					data[fieldName]=i.val();
				}
			});
			/*$.each(chbxInputs, function(index,i){
				i = $(i);
				var fieldName = i.attr('name');
				data[fieldName]=i.is(':checked') ? 1 : 0;
			});
			$.each(selectInputs, function(index,i){
				i=$(i);
				var fieldName = i.attr('name');
				data[fieldName] = $(i.children('option:selected')[0]).attr('value');
				console.log('select found---'+fieldName);
			});
			$.each(textAreas, function(index,i){
				i=$(i);
				var fieldName = i.attr('name');
				data[fieldName] = i.val();				
			});*/
			//Nodes:
			var nodes={};//TODO

			data.nodes=JSON.stringify(nodes);
			console.log(data);
			if(id>0){
				console.log('ajax');
				$.ajax({
					type: "post",
					url: '/api/managers/'+id,
					data: data,
					success: function(response) {
						console.log(response);
						//TODO add an "saved" notification
					}
				});
			}
		});
		$('#tbl-managers').on('click','.edit',function(){
			var managerId = $($(this).parents('tr')[0]).attr('data-id');
			console.log(campaignId);
			loadManagers(managerId);
			$('#managers-list').hide();
			$('#edit-manager').show();
		});
		$('#tbl-managers').on('click','.delete',function(){
			var managerId = $($(this).closest('tr')[0]).attr('data-id');
			console.log('before delete -managerId: '+managerId);
			$.ajax({
				type: "delete",
				url: '/api/managers/'+managerId,
				success: function(deletedId){console.log('deleted! id: '+deletedId);}
			});
			$($(this).parents('tr')[0]).remove();
		});
		//TRIGGERS SECTION:
	});
	</script>
</body>
<!-- END BODY -->
</html>
